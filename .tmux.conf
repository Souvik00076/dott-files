# Use reattach-to-user-namespace for proper clipboard integration on macOS
set-option -g default-command "reattach-to-user-namespace -l /bin/zsh"
set-option -g default-shell /bin/zsh

set -g mouse on
set-window-option -g mode-keys vi

unbind C-b
set -g prefix M-a
bind M-a send-prefix

# Select pane left
bind -n M-h select-pane -L
# Select pane right
bind -n M-l select-pane -R
# Select pane up
bind -n M-k select-pane -U
# Select pane down
bind -n M-j select-pane -D

# Additional useful Alt bindings for common operations
bind -n M-f split-window -h -c "#{pane_current_path}" # Split horizontally
bind -n M-d split-window -v -c "#{pane_current_path}" # Split vertically

# Change window selection menu to Alt+n (no prefix needed)
bind -n M-t choose-tree -w

# Use Alt+r to rename window (no prefix needed)
bind -n M-r command-prompt -I "#W" "rename-window '%%'"
bind -n M-n new-window -c "#{pane_current_path}"  # Alt+n to create new window

bind -n M-g if -F "#{>:#{window_panes},1}" "kill-pane" "kill-window"
bind -n M-c if -F '#{pane_in_mode}' 'send-keys -X cancel' 'copy-mode'   # Alt+c to toggle copy mode
bind -n M-w if -F "#{==:#{window_index},#{last_window_index}}" "select-window -t 0" "select-window -n"    # Cycle through windows
bind -n M-i if -F '#{window_zoomed_flag}' 'resize-pane -Z' 'select-pane -t :.+; resize-pane -Z; select-pane -t :.-'    # Toggle zoom on unfocused pane

# macOS clipboard integration for copy mode
bind -T copy-mode-vi v send -X begin-selection
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
bind -T copy-mode-vi MouseDragEnd1Pane send -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"
